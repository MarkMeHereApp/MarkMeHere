generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum UserType {
  ADMIN
  STUDENT
  PROFESSOR
}

model User {
  id                          String              @id @unique @map("user_id")
  userType                    UserType?
  email                       String              @unique
  firstName                   String?             @default("null") @db.VarChar(255)
  lastName                    String?             @default("null") @db.VarChar(255)
  fullName                    String?             @default("null") @db.VarChar(255)
  dateCreated                 DateTime            @default(now()) @map("created_at")
  password                    String              @db.VarChar(255)
  coursesAsStudent            Course[]           
  coursesAsProfessor          Course[]            
  coursesAsAdmin              Course[]        
  lecturesAttendanceAsStudent LectureAttendance[] @relation("StudentAttendance")
}

model Lecture {
  id             String              @id @map("lecture_id")
  startDate      DateTime            @map("start_date")
  endDate        DateTime            @map("end_date")
  attendanceDate DateTime            @map("attendance_date")
  attendance     LectureAttendance[] @relation("LectureAttendance")
  courses        Course[]            @relation("Lectures")
}

model LectureAttendance {
  id         Int      @id @default(autoincrement())
  lecture    Lecture  @relation("LectureAttendance", fields: [lectureId], references: [id])
  lectureId  String
  student    User     @relation("StudentAttendance", fields: [studentId], references: [id])
  studentId  String
  attendedAt DateTime @default(now())

  @@unique([lectureId, studentId])
}

model Course {
  id          String    @id @map("course_id")
  students    User[]    @relation("StudentEnrollments")
  admins      User[]    @relation("Admins")
  professors  User[]    @relation("Professors")
  dateCreated DateTime  @default(now()) @map("created_at")
  startDate   DateTime  @map("start_date")
  endDate     DateTime? @map("end_date")
  lectures    Lecture[] @relation("Lectures")
}
